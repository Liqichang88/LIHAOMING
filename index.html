<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Units 1–5 资源中心</title>
    <style>
      :root {
        color-scheme: light dark;
        --bg: #0f172a;
        --fg: #e2e8f0;
        --muted: #94a3b8;
        --card: #111827;
        --accent: #3b82f6;
        --border: #1f2937;
      }
      html, body { height: 100%; }
      body {
        margin: 0; font-family: system-ui, -apple-system, Segoe UI, Roboto, "PingFang SC", "Microsoft YaHei", "Noto Sans CJK SC", Arial, "Hiragino Sans GB", sans-serif;
        background: var(--bg); color: var(--fg);
        display: grid; grid-template-rows: auto 1fr auto;
      }
      header { padding: 20px 24px; border-bottom: 1px solid var(--border); display: grid; gap: 6px; }
      header h1 { margin: 0; font-size: 20px; }
      header p { margin: 0; color: var(--muted); font-size: 13px; }
      .toolbar { display: flex; flex-wrap: wrap; gap: 10px; align-items: center; margin-top: 6px; }
      .toolbar input[type="search"] { flex: 1 1 240px; border-radius: 8px; border: 1px solid var(--border); padding: 8px 10px; background: var(--card); color: var(--fg); }
      .toolbar .chips { display: flex; gap: 6px; flex-wrap: wrap; }
      .chip { border: 1px solid #334155; color: var(--muted); border-radius: 999px; padding: 4px 10px; font-size: 12px; cursor: pointer; user-select: none; }
      .chip.active { color: var(--fg); border-color: var(--accent); box-shadow: 0 0 0 2px var(--accent) inset; }
      .open-mode { display: flex; gap: 8px; align-items: center; font-size: 12px; color: var(--muted); }
      .open-mode label { display: inline-flex; gap: 6px; align-items: center; cursor: pointer; }
      main { display: grid; grid-template-columns: 1.1fr 1.5fr; gap: 12px; padding: 16px 24px; }
      @media (max-width: 900px) { main { grid-template-columns: 1fr; } #viewer { min-height: 52vh; } }
      .panel { background: var(--card); border: 1px solid var(--border); border-radius: 12px; overflow: hidden; display: grid; grid-template-rows: auto 1fr; }
      .panel h2 { margin: 0; padding: 12px 14px; font-size: 15px; border-bottom: 1px solid var(--border); }
      .list { list-style: none; margin: 0; padding: 10px; display: grid; gap: 8px; }
      .item { display: grid; grid-template-columns: auto 1fr auto; gap: 10px; align-items: center; border: 1px solid var(--border); border-radius: 10px; padding: 8px 10px; }
      .item:hover, .item:focus-within { box-shadow: 0 0 0 2px var(--accent) inset; }
      .badge { font-size: 12px; color: var(--muted); padding: 2px 8px; border: 1px solid #334155; border-radius: 999px; }
      .title { white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
      .actions { display: flex; gap: 8px; }
      .btn { border: 1px solid #334155; background: transparent; color: var(--fg); border-radius: 8px; padding: 6px 10px; font-size: 12px; cursor: pointer; }
      .btn:hover { border-color: var(--accent); }
      #viewer { background: #0b1220; border: 1px solid var(--border); border-radius: 12px; overflow: hidden; }
      #viewer .placeholder { display: grid; place-items: center; color: var(--muted); height: 100%; min-height: 420px; }
      #viewer iframe, #viewer embed { width: 100%; height: 72vh; border: 0; }
      footer { padding: 16px 24px; border-top: 1px solid var(--border); color: var(--muted); font-size: 12px; }
    </style>
  </head>
  <body>
    <header>
      <h1>Units 1–5 资源中心</h1>
      <p>搜索、筛选并在右侧内嵌预览，或选择新标签打开。</p>
      <div class="toolbar" role="toolbar" aria-label="资源筛选与打开方式">
        <input id="q" type="search" placeholder="搜索文件名或类型（PDF/HTML）" aria-label="搜索资源" />
        <div class="chips" id="typeChips" aria-label="类型筛选"></div>
        <div class="chips" id="unitChips" aria-label="单元筛选"></div>
        <div class="open-mode" role="radiogroup" aria-label="打开方式">
          <label><input type="radio" name="openMode" value="preview" checked /> 右侧预览</label>
          <label><input type="radio" name="openMode" value="page" /> 当前页全屏显示</label>
          <label><input type="radio" name="openMode" value="newtab" /> 新标签打开</label>
        </div>
      </div>
    </header>
    <main>
      <div class="panel" aria-labelledby="listTitle">
        <h2 id="listTitle">资源列表</h2>
        <ul id="list" class="list" role="list" aria-live="polite"></ul>
      </div>
      <div id="viewer" class="panel" aria-labelledby="viewerTitle" aria-live="polite">
        <h2 id="viewerTitle">预览</h2>
        <div class="placeholder">请选择左侧条目进行预览，或切换为“新标签”。</div>
      </div>
    </main>
    <footer>
      <div>资源目录：c:\Users\liqic\Desktop\重难难点纸张\第一至第五单元重难难点纸张</div>
    </footer>
    <script>
      const resources = [
        { type: 'pdf', unit: 1, name: 'U1重难点纸张.pdf', href: './U1重难点纸张.pdf' },
        { type: 'pdf', unit: 2, name: 'U2重难点纸张.pdf', href: './U2重难点纸张.pdf' },
        { type: 'pdf', unit: 3, name: 'U3重难点纸张.pdf', href: './U3重难点纸张.pdf' },
        { type: 'pdf', unit: 4, name: 'U4重难点纸张.pdf', href: './U4重难点纸张.pdf' },
        { type: 'pdf', unit: 5, name: 'U5重难点纸张.pdf', href: './U5重难点纸张.pdf' },
        { type: 'html', unit: 1, name: 'Unit 1 英语重难点复习应用 (Electron Bundle)_Final.html', href: './Unit 1 英语重难点复习应用 (Electron Bundle)_Final.html' },
        { type: 'html', unit: 2, name: 'Unit 2英语重难点复习应用 (Electron Bundle)_Final.html', href: './Unit 2英语重难点复习应用 (Electron Bundle)_Final.html' },
        { type: 'html', unit: 3, name: 'Unit 3英语重难点复习应用 (Electron Bundle)_Final.htm', href: './Unit 3英语重难点复习应用 (Electron Bundle)_Final.htm' },
        { type: 'html', unit: 4, name: 'Unit 4英语重难点复习应用 (Electron Bundle)_Final.htm', href: './Unit 4英语重难点复习应用 (Electron Bundle)_Final.htm' },
        { type: 'html', unit: 5, name: 'Unit 5 英语重难点复习应用 (Electron Bundle)_Final.html', href: './Unit 5 英语重难点复习应用 (Electron Bundle)_Final.html' },
      ];

      const state = { query: '', type: 'all', unit: 'all', openMode: 'preview' };

      const q = document.getElementById('q');
      const list = document.getElementById('list');
      const viewer = document.getElementById('viewer');
      const typeChips = document.getElementById('typeChips');
      const unitChips = document.getElementById('unitChips');

      // Build chips
      const typeOptions = ['all', 'pdf', 'html'];
      typeOptions.forEach(t => {
        const el = document.createElement('button');
        el.className = 'chip' + (t === 'all' ? ' active' : '');
        el.type = 'button';
        el.setAttribute('aria-pressed', t === 'all');
        el.textContent = t.toUpperCase();
        el.addEventListener('click', () => {
          [...typeChips.children].forEach(c => c.classList.remove('active'));
          el.classList.add('active');
          state.type = t;
          render();
        });
        typeChips.appendChild(el);
      });

      const unitOptions = ['all', 1, 2, 3, 4, 5];
      unitOptions.forEach(u => {
        const el = document.createElement('button');
        el.className = 'chip' + (u === 'all' ? ' active' : '');
        el.type = 'button';
        el.setAttribute('aria-pressed', u === 'all');
        el.textContent = u === 'all' ? '全部单元' : `Unit ${u}`;
        el.addEventListener('click', () => {
          [...unitChips.children].forEach(c => c.classList.remove('active'));
          el.classList.add('active');
          state.unit = u;
          render();
        });
        unitChips.appendChild(el);
      });

      // Open mode radio
      document.querySelectorAll('input[name="openMode"]').forEach(r => {
        r.addEventListener('change', () => {
          state.openMode = r.value;
        });
      });

      // Search
      q.addEventListener('input', () => { state.query = q.value.trim().toLowerCase(); render(); });

      function render() {
        const filtered = resources
          .filter(r => state.type === 'all' ? true : r.type === state.type)
          .filter(r => state.unit === 'all' ? true : r.unit === state.unit)
          .filter(r => !state.query || r.name.toLowerCase().includes(state.query) || r.type.includes(state.query));

        filtered.sort((a, b) => a.unit - b.unit || a.type.localeCompare(b.type));

        list.innerHTML = '';
        filtered.forEach((r, idx) => {
          const li = document.createElement('li');
          li.className = 'item';
          li.setAttribute('role', 'listitem');
          li.tabIndex = 0;
          li.innerHTML = `
            <span class="badge">${r.type.toUpperCase()}</span>
            <div class="title" title="${r.name}">${r.name}</div>
            <div class="actions">
              <button class="btn" data-action="preview">预览</button>
              <a class="btn" href="${r.href}" target="_blank" rel="noopener">新标签</a>
            </div>
          `;
          li.querySelector('[data-action="preview"]').addEventListener('click', () => open(r));
          li.addEventListener('keydown', (e) => { if (e.key === 'Enter') open(r); });
          list.appendChild(li);
        });

        if (!filtered.length) {
          const li = document.createElement('li');
          li.className = 'item';
          li.innerHTML = '<div class="title">未找到匹配资源</div>';
          list.appendChild(li);
        }
      }

      function open(r) {
        if (state.openMode === 'newtab') {
          window.open(r.href, '_blank', 'noopener');
          return;
        }
        const isPDF = r.type === 'pdf';
        viewer.querySelector('.placeholder')?.remove();
        viewer.lastElementChild?.remove();
        const container = document.createElement(isPDF ? 'embed' : 'iframe');
        if (isPDF) container.type = 'application/pdf';
        container.src = r.href;
        viewer.appendChild(container);
        try { localStorage.setItem('lastOpen', JSON.stringify(r)); } catch {}
      }

      // Restore last open
      try {
        const last = JSON.parse(localStorage.getItem('lastOpen') || 'null');
        if (last) open(last);
      } catch {}

      render();
    </script>
    <!-- 全屏覆盖层（当前页全屏显示时使用） -->
    <div id="overlay" hidden>
      <header>
        <button class="back" id="goHome" aria-label="返回主页">返回主页</button>
        <div class="title" id="overlayTitle">—</div>
      </header>
      <div class="content" id="overlayContent"></div>
    </div>
    <style>
      /* 全屏覆盖层样式（置于文末以避免选择器冲突） */
      #overlay[hidden] { display: none; }
      #overlay { position: fixed; inset: 0; background: #0b1220; z-index: 1000; display: grid; grid-template-rows: auto 1fr; }
      #overlay header { display: flex; align-items: center; gap: 12px; padding: 10px 14px; border-bottom: 1px solid var(--border); }
      #overlay header .title { font-size: 14px; color: var(--muted); flex: 1; }
      #overlay .back { border: 1px solid #334155; background: transparent; color: var(--fg); border-radius: 8px; padding: 6px 10px; font-size: 12px; cursor: pointer; }
      #overlay .back:hover { border-color: var(--accent); }
      #overlay .content iframe, #overlay .content embed { width: 100%; height: calc(100vh - 54px); border: 0; }
    </style>
  </body>
</html>